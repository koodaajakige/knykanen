create table testi (avain integer primary key, sana varchar(10));
insert into testi values(1, 'Haha'),(2, 'Hehe'),(5, 'LOL'),(6, 'Hihi');
select * from testi;
drop table testi;
\d
\q
create table kirjasto(isbn integer primary key not null,sukunimi varchar (20) not null,etunimi varchar (20) not null,kirja varchar (30) not null,hyllypaikka varchar (10) not null,saatavuus varchar (8) not null;);
\q
create table kirjasto (isbn integer primary key not null,sukunimi varchar (20) not null,etunimi varchar (20) not null,kirja varchar (30) not null,hyllypaikka varchar (10) not null,saatavuus varchar (8) not null);
\b
\d
insert into kirjasto values(9789512087600, 'P√§√§talo', 'Kalle', 'Myrskyn j√§lkeen', 'A2', 'lainassa');
drop table kirjasto;
\d
create table kirjasto(isbn char (13) not null,sukunimi varchar (20) not null,kirja varchar (30) not null);
\d
insert into kirjasto values('9789512087600', 'P√§√§talo', 'Myrsky');
\d
\kirjasto
select from * kirjasto;
select * from kirjasto;
drop table kirjasto;
\d
create table kirjasto (isbn char (13) primary key not null,sukunimi varchar (20) not null,etunimi varchar (20) not null,kirja varchar (30) not null,hyllypaikka varchar (10) not null,saatavuus varchar (8) not null);
select * from kirjasto;
insert into kirjasto values('9789512087600', 'P√§√§talo', 'Kalle', 'Myrskyn j√§lkeen', 'A2', 'lainassa');
insert into kirjasto values('9790550095199', 'Laaksonen', 'Heli', 'Pikavuaro Turkku', 'B4', 'hyllyss√§');
select * from kirjasto;
insert into kirjasto values('9789511058571', 'Kunnas', 'Mauri', 'Koiram√§en talossa', 'C8', 'hyllyss√§');
insert into kirjasto values('9789527315453', 'Polva', 'Anni', 'Tiina', 'D6', 'lainassa');
insert into kirjasto values('9789510453810', 'Christie', 'Agatha', 'Varjossa auringon alla', 'E10', 'lainassa');
select *from kirjasto;
\d
create table vieras (vid serial primary key,mess varchar(500),kir varchar(20),aika time,pvm date);
\d
GRANT ALL ON vieras TO db_knykanen;
GRANT ALL ON vieras_vid_seq TO db_knykanen;
select * from vieras;
\q
\d
drop table vieras;
create table vieras (knykanen(> vid serial primary key,knykanen(> mess varchar(500),knykanen(> kirj varchar(20),knykanen(> aika time,knykanen(> pvm date);drop table vieras;;
\q
\d
create table vieras (vid serial primary key,mess varchar(500),kirj varchar(20),aika time,pvm date);
\d
select * from vieras;
\q
\d
select * from vieras;
psqldrop table vieras;
drop table vieras;
create table vieras (vid serial primary key,mess varchar(500),kirj varchar(20),aika time,pvm date);
\d
select * from vieras;
\d vieras
drop table vieras;
create table vieras (vid serial primary key,mess varchar(500),kirj varchar(20),aika time,pvm date);
GRANT ALL ON vieras TO db_knykanen;
GRANT ALL ON vieras_vid_seq TO db_knykanen;
\q
select * from elokuva;
;
psqlselect * from elokuva;
\q
\d
drop table elokuva;
create table elokuva (vid serial primary key,nimi varchar(30),ohjaaja varchar(40),genre varchar(20),vuosi integer,miespaaosa varchar(40),naispaaosa varchar(40));
GRANT ALL ON elokuva TO db_knykanen;
GRANT ALL ON elokuva_vid_seq TO db_knykanen;
insert into elokuva(nimi, ohjaaja, genre, vuosi, miespaaosa, naispaaosa)values ('Rosvo-Roope', 'Hannu Leminen', 'Romantiikka', 1949, 'Tauno Palo', 'Helena Kara');
insert into elokuva(nimi, ohjaaja, genre, vuosi, miespaaosa, naispaaosa)values ('Matrix', 'Wachowskin sisarukset', 'Scifi', 1999, 'Keanu Reeves', 'Carrie-Anne Moss');
insert into elokuva(nimi, ohjaaja, genre, vuosi, miespaaosa, naispaaosa)values ('Takaikkuna', 'Alfred Hitchcock', 'Trilleri', 1954, 'James Stewart', 'Grace Kelly');
insert into elokuva(nimi, ohjaaja, genre, vuosi, miespaaosa, naispaaosa)values ('La La Land', 'Damien Chazelle', 'Musikaali', 2016, 'Ryan Gosling', 'Emma Stone');
insert into elokuva(nimi, ohjaaja, genre, vuosi, miespaaosa, naispaaosa)values ('Uuno Turhapuro muuttaa maalle', 'Ere Kokkonen', 'Komedia', 1986, 'Vesa-Matti Loiri', 'Marjatta Raita');
insert into elokuva(nimi, ohjaaja, genre, vuosi, miespaaosa, naispaaosa)values ('The Shining - Hohto', 'Stanley Kubrick', 'Kauhu', 1980, 'Jack Nicholson', 'Shelley Duvall');
insert into elokuva(nimi, ohjaaja, genre, vuosi, miespaaosa, naispaaosa)values ('Titanic', 'James Cameron', 'Draama', 1997, 'Leonardo DiCaprio', 'Kate Winslet');
insert into elokuva(nimi, ohjaaja, genre, vuosi, miespaaosa, naispaaosa)values ('Tuulen viem√§√§', 'Victor Fleming', 'Romantiikka', 1950, 'Clark Gable', 'Vivien Leigh');
insert into elokuva(nimi, ohjaaja, genre, vuosi, miespaaosa, naispaaosa)values ('Imperiumin vastaisku', 'Irvin Kershner', 'Scifi', 1980, 'Mark Hamill', 'Carrie Fisher');
insert into elokuva(nimi, ohjaaja, genre, vuosi, miespaaosa, naispaaosa)values ('Itse ilkimys', 'Pierre Coffin', 'Animaatio', 2010, 'Steve Carell', 'Kristen Wiig');
select *from elokuva;
\q
\d
[200~CREATE TABLE Genre (genreid integer primary key,nimi varchar(100) not null
\d
\q
insert into Kustantaja values(5, 'Tammi', 'www.tammi.fi'),
\q
insert into Kustantaja values(5, 'Tammi', 'www.tammi.fi'),
\q
\d
insert into Kustantaja values(5, 'Tammi', 'www.tammi.fi');
insert into Kirja values(2, 'Supermarsu ja kavala koodi', 6, 5, 3, 2019);
insert into Kirja values(2, 'Anna Karenina', 2, 2, 6, 1877); 
insert into Kirja values(3, 'Anna Karenina', 2, 2, 6, 1877);
insert into Kirja values(4, 'Tuntematon sotilas', 3, 2, 7, 1877);
insert into Kirja values(5, 'Nuoruuden savotat', 4, 3, 1, 1975);
select * from Kirja;
insert into Kirja values(6, 'Komisario Palmun erehdys', 5, 2, 4, 1940);
select * from Asiakas;
insert into Asiakas values('111159-111P', 'Heikki', 'Helppo','Iisitie 5 C', '07900'),('120766-126L', 'Maikki', 'Mielonen','Ryydynkatu 6 A', '06100'),('090588-233G', 'Seppo', 'Sankari','Haukikuja 24 H', '95620'),('020865-937T', 'Eija', 'Jantunen','Kalliotie 15 C', '00990'),('260390-458V', 'Joni', 'Laavunen','Lahnapolku 7 B', '33101'),('190576-845J', 'Sirpa', 'Savikko','Toosintie 6 A', '07900');
select * from Asiakas;
CREATE TABLE Lainaus (lainausid varchar NOT NULL,paivamaara DATE NOT NULL,PRIMARY KEY (lainausid),CONSTRAINT FK_Asiakas FOREIGN KEY (asiakasidd) REFERENCES Asiakas (hetuid),CONSTRAINT FK_Kirja FOREIGN KEY (kirjaidd) REFERENCES Kirja(kirjaid));
CREATE TABLE Lainaus (asiakas CHAR(11) NOT NULL,laina CHAR(6) NOT NULL,paivamaara DATE NOT NULL,CONSTRAINT Lainaus_PK PRIMARY KEY (asiakas, laina, paivamaara),CONSTRAINT Lainaus_FK_Op FOREIGN KEY (asiakas) REFERENCES Asiakas (hetuid),CONSTRAINT Lainaus_FK_K FOREIGN KEY (laina) REFERENCES Kirja(kirjaid));
drop table Lainaus;
CREATE TABLE Lainaus (lainausid integer primary key,paivamaara DATE NOT NULL,kirjaidd integer references Kirja(kirjaid),asiakasidd char(11) references Asiakas(hetuid)maara INTEGER NOT NULL DEFAULT 1,);
CREATE TABLE Lainaus (lainausid integer primary key,paivamaara DATE NOT NULL,kirjaidd integer references Kirja(kirjaid),asiakasidd char(11) references Asiakas(hetuid),maara INTEGER NOT NULL DEFAULT 1);
insert into Lainaus values(11, '2024-01-12', 6, '120766-126L', 1),(12, '2024-01-12', 7, '111159-111P', 1),(13, '2024-01-13', 8, '120766-126L', 1),(14, '2024-01-14', 9, '020865-937T', 1);
select * from Lainaus;
insert into Lainaus values(1, '2024-01-2', 6, '120766-126L', 1),(2, '2024-01-2', 7, '120766-126L', 1),(3, '2024-01-2', 8, '120766-126L', 1),(4, '2024-01-3', 9, '020865-937T', 1),(5, '2024-01-4', 6, '111159-111P', 1),(6, '2024-01-4', 7, '111159-111P', 1),(7, '2024-01-5', 8, '020865-937T', 1),(8, '2024-01-5', 9, '020865-937T', 1),(9, '2024-01-6', 6, '090588-233G', 1),(10, '2024-01-6', 7, '090588-233G', 1);
select count (maara) from Lainaus;
select count (maara) from Lainaus, Asiakas.asiakassukunimi, Asiakas.asiakasetunimiwhere asiakasidd=hetuid;
select A.asiakassukunimi, A.asiakasetunimi, L.maarafrom Asiakas A, Lainaus Lwhere L.asiakasidd=A.hetuid;
select L.maara, A.asiakassukunimi, A.asiakasetunimifrom Lainaus L, Asiakas A where L.asiakasidd=A.hetuid;
select L.maara, DISTINCT A.asiakassukunimi, DISTINCT A.asiakasetunimifrom Lainaus L, Asiakas A where L.asiakasidd=A.hetuid;
select count (L.maara), DISTINCT A.asiakassukunimi, DISTINCT A.asiakasetunimifrom Lainaus L, Asiakas A where L.asiakasidd=A.hetuid;
select DISTINCT count (L.maara),  A.asiakassukunimi, A.asiakasetunimifrom Lainaus L, Asiakas A where L.asiakasidd=A.hetuid;
select L.maara, A.asiakassukunimi, A.asiakasetunimifrom Lainaus L, Asiakas A where L.asiakasidd=A.hetuidORDER BY A.asiakasetunimi DESC, A.asiakassukunimi DESC;
select L.maara, A.asiakassukunimi, A.asiakasetunimifrom Lainaus L, Asiakas A where L.asiakasidd=A.hetuidORDER BY count(L.maara), A.asiakassukunimi DESC;
select L.maara, A.asiakassukunimi, A.asiakasetunimifrom Lainaus L, Asiakas A where L.asiakasidd=A.hetuidORDER BY A.asiakassukunimi ASC;
select L.maara, A.asiakassukunimi, A.asiakasetunimifrom Lainaus L, Asiakas A where L.asiakasidd=A.hetuidGROUP BY asiakasiddORDER BY A.asiakassukunimi ASC;
select count(L.maara), A.asiakassukunimi, A.asiakasetunimifrom Lainaus L, Asiakas A where L.asiakasidd=A.hetuidGROUP BY asiakasiddORDER BY A.asiakassukunimi ASC;
select count(L.maara), A.asiakassukunimi, A.asiakasetunimifrom Lainaus L, Asiakas A where L.asiakasidd=A.hetuidGROUP BY asiakasiddORDER BY maara ASC;
select count(L.maara), A.asiakassukunimi, A.asiakasetunimifrom Lainaus L, Asiakas A where L.asiakasidd=A.hetuidGROUP BY asiakasidd.A.asiakassukunimiORDER BY maara ASC;
select count(L.maara), A.asiakassukunimi, A.asiakasetunimifrom Lainaus L, Asiakas A where L.asiakasidd=A.hetuidGROUP BY A.asiakassukunimiORDER BY maara ASC;
select count(L.maara), A.asiakassukunimi, A.asiakasetunimifrom Lainaus L, Asiakas A where L.asiakasidd=A.hetuidGROUP BY A.asiakassukunimi, A.asiakasetunimiORDER BY maara ASC;
select count(L.maara), A.asiakassukunimi, A.asiakasetunimifrom Lainaus L, Asiakas A where L.asiakasidd=A.hetuidGROUP BY maara, A.asiakassukunimi, A.asiakasetunimiORDER BY maara ASC;
select count(L.maara), A.asiakassukunimi, A.asiakasetunimifrom Lainaus L, Asiakas A where L.asiakasidd=A.hetuidGROUP BY maara, A.asiakassukunimi, A.asiakasetunimiORDER BY maara ASC, A.asiakassukunimi ASC;
select count(L.maara), A.asiakassukunimi, A.asiakasetunimifrom Lainaus L, Asiakas A where L.asiakasidd=A.hetuidGROUP BY maara, A.asiakassukunimi, A.asiakasetunimiORDER BY count(maara) ASC, A.asiakassukunimi ASC;
select count(L.maara), A.asiakassukunimi, A.asiakasetunimifrom Lainaus L, Asiakas A where L.asiakasidd=A.hetuidGROUP BY maara, A.asiakassukunimi, A.asiakasetunimiORDER BY count(maara) DESC, A.asiakassukunimi ASC;
select count(L.maara), K.nimifrom Lainaus L, Kirja Kwhere L.kirjaidd=K.kirjaidGROUP BY maara, K.nimiORDER BY count(maara) ASC, K.nimi ASC;
select count(L.maara), K.nimifrom Lainaus L, Kirja Kwhere L.kirjaidd=K.kirjaidGROUP BY maara, K.nimiORDER BY count(maara) DESC, K.nimi ASC;
select * from Lainaus;
drop table Lainaus;
CREATE TABLE Lainaus (lainausid integer primary key,paivamaara DATE NOT NULL,kirjaidd integer references Kirja(kirjaid),asiakasidd char(11) references Asiakas(hetuid),maara INTEGER NOT NULL DEFAULT 1);
insert into Lainaus values(1, '2024-01-2', 1, '120766-126L', 1),(2, '2024-01-2', 2, '120766-126L', 1),(3, '2024-01-2', 3, '120766-126L', 1),(4, '2024-01-3', 4, '020865-937T', 1),(5, '2024-01-4', 5, '111159-111P', 1),(6, '2024-01-4', 1, '111159-111P', 1),(7, '2024-01-5', 6, '020865-937T', 1),(8, '2024-01-5', 7, '020865-937T', 1),(9, '2024-01-6', 2, '090588-233G', 1),(10, '2024-01-6', 3, '090588-233G', 1),(11, '2024-01-6', 4, '090588-233G', 1),(12, '2024-01-7', 8, '190576-845J', 1),(13, '2024-01-7', 2, '190576-845J', 1),(14, '2024-01-7', 9, '190576-845J', 1);
select count(L.maara), A.asiakassukunimi, A.asiakasetunimifrom Lainaus L, Asiakas A where L.asiakasidd=A.hetuidGROUP BY maara, A.asiakassukunimi, A.asiakasetunimiORDER BY count(maara) DESC, A.asiakassukunimi ASC;
select count(L.maara), K.nimifrom Lainaus L, Kirja Kwhere L.kirjaidd=K.kirjaidGROUP BY maara, K.nimiORDER BY count(maara) DESC, K.nimi ASC;
\d
CREATE TABLE Facts ( continent character varying(30), -- maanosa country character varying(100), -- valtio (* gdp_percapita numeric(7,0), -- BKT per nen√§ dollareissa area numeric(9,0), -- maapinta-ala pop numeric(11,0) -- v√§kiluku);
select * from facts;
- \COPY Facts from '/homes/knykanen/cia2017.csv' WITH DELIMITER ',';
- \COPY Facts from '/home/knykanen/cia2017.csv' WITH DELIMITER ',';
- \COPY Facts from '/knykanen/cia2017.csv' WITH DELIMITER ',';
North America,Canada,46200,9984670,35362905Central Asia,Turkmenistan,17300,488100,5291317North America,Saint Pierre and Miquelon,34900,242,5595Africa,Ethiopia,1900,1104300,102374044Africa,Swaziland,9800,17364,1451428Africa,Cameroon,3300,475440,24360803Africa,Burkina Faso,1800,274200,19512533Australia-Oceania,Cocos (Keeling) Islands,\N,14,596
Europe,Bosnia and Herzegovina,11000,51197,3861912Central America and Caribbean,Dominica,11400,751,73757Africa,Liberia,900,111369,4299944South Asia,Maldives,15300,298,392960Africa,Tanzania,3100,947300,52482726Australia-Oceania,Christmas Island,\N,135,2205
Europe,Monaco,115700,2,30581Australia-Oceania,Wallis and Futuna,3800,142,15664Europe,Jersey,49500,116,98069East & Southeast Asia,Macau,96100,28.2,597425Europe,Svalbard,\N,62045,2667
East & Southeast Asia,South Korea,37900,99720,50924172Central Asia,Tajikistan,3000,144100,8330946Middle East,Turkey,21100,783562,80274604South America,Falkland Islands,96200,12173,2931Middle East,Gaza Strip,\N,360,1753327
Europe,France,42400,643801,66836154Europe,Slovakia,31200,49035,5445802Australia-Oceania,Vanuatu,2600,12189,277554Australia-Oceania,Nauru,14800,21,9591Africa,Seychelles,28000,455,93186Europe,Norway,69300,323802,5265158Africa,Malawi,1100,118484,18570321Europe,Montenegro,17000,13812,644578Africa,Republic of the Congo,6800,342000,4852412Central America and Caribbean,Virgin Islands,36100,1910,102951East & Southeast Asia,Timor-Leste,4200,14874,1261072Central America and Caribbean,Dominican Republic,15900,48670,10606865Middle East,Bahrain,50300,760,1378904Central America and Caribbean,Cayman Islands,43800,264,57268Africa,Libya,14200,1759540,6541948Europe,Finland,40600,338145,5498211Africa,Central African Republic,700,622984,5507257Europe,Liechtenstein,139100,160,37937North America,United States,57300,9833517,323995528Europe,Portugal,28500,92090,10833816Australia-Oceania,Fiji,9400,18274,915303East & Southeast Asia,Malaysia,27200,329847,30949962Central America and Caribbean,Saint Martin,19300,54.4,31949Central America and Caribbean,The Bahamas,24600,13880,327316Central America and Caribbean,Panama,22800,75420,3705246Central America and Caribbean,Costa Rica,16100,51100,4872543Europe,Luxembourg,102000,2586,582291Europe,Andorra,49900,468,85660Europe,Gibraltar,61700,6.5,29328Europe,Ireland,69400,70273,4952473Europe,Italy,36300,301340,62007540Africa,Nigeria,5900,923768,186053386South America,Ecuador,11000,283561,16080778Australia-Oceania,Australia,48800,7741220,22992654Central America and Caribbean,El Salvador,8900,21041,6156670Australia-Oceania,Tuvalu,3500,26,10959Australia-Oceania,Pitcairn Islands,\N,47,54
East & Southeast Asia,Thailand,16800,513120,68200824Central America and Caribbean,Belize,8200,22966,353858East & Southeast Asia,Hong Kong,58100,1108,7167403Europe,Sierra Leone,33100,20273,1978029Middle East,Georgia,10100,69700,4928052Europe,Denmark,46600,43094,5593785East & Southeast Asia,Philippines,7700,300000,102624209Europe,Moldova,5200,33851,3510485Africa,Morocco,8400,446550,33655786Europe,Guernsey,52400,78,66297Europe,Estonia,29500,45228,1258545Europe,Kosovo,9600,10887,1883018Middle East,Lebanon,18500,10400,6237738Central Asia,Uzbekistan,6500,447400,29473614South America,Colombia,14100,1138910,47220856East & Southeast Asia,Taiwan,49500,35980,23464787Europe,Cyprus,34400,9251,1205575Central America and Caribbean,Barbados,17200,430,291495Africa,Madagascar,1500,587041,24430325Australia-Oceania,Palau,15300,459,21347Africa,Sudan,4500,1861484,36729501South Asia,Nepal,2500,147181,29033914Europe,Netherlands,50800,41543,17016967South America,Suriname,15200,163820,585824Central America and Caribbean,Anguilla,12200,91,16752Europe,Holy See,\N,0.44,1000
Middle East,Israel,34800,20770,8174527South America,Venezuela,15100,912050,30912302Africa,Senegal,2600,196722,14320055East & Southeast Asia,Papua New Guinea,3500,462840,6791317Africa,Zimbabwe,1700,390757,14546961Middle East,Jordan,11100,89342,8185384Africa,Mauritania,4400,1030700,3677293Central America and Caribbean,Trinidad and Tobago,31900,5128,1220479Europe,Latvia,25700,64589,1965686Europe,Hungary,27200,93028,9874784Middle East,Syria,2900,185180,17185170Central America and Caribbean,Sint Maarten,66800,34,41486North America,Mexico,18900,1964375,123166749Europe,Serbia,14200,77474,7143921Europe,United Kingdom,42500,243610,64430428Europe,Greece,26800,131957,10773253South America,Paraguay,9500,406752,6862812Africa,Botswana,16900,581730,2209208Africa,Sao Tome and Principe,3300,964,197541Europe,Lithuania,29900,65300,2854235East & Southeast Asia,Cambodia,3700,181035,15957223Africa,The Gambia,1700,11300,2009648Central America and Caribbean,Aruba,25300,180,113648South America,Argentina,20200,2780400,43886748South America,Bolivia,7200,1098581,10969649Africa,Ghana,4400,238533,26908262Middle East,Saudi Arabia,54100,2149690,28160273Australia-Oceania,American Samoa,13000,199,54194Europe,Slovenia,33100,20273,1978029Central America and Caribbean,Guatemala,7900,108889,15189958Africa,Guinea,1300,245857,12093349Africa,Saint Helena\, Ascension\, and Tristan da Cunha,7800,308,7795
Central America and Caribbean,Saint Barthelemy,\N,25,7209
Europe,Spain,36500,505370,48563476Central America and Caribbean,Jamaica,9000,10991,2970340Middle East,Oman,43700,309500,3355262Africa,Cabo Verde,6700,4033,553432North America,Greenland,37600,2166086,57728Africa,Gabon,19300,267667,1738541Australia-Oceania,Niue,5800,260,1190Middle East,West Bank,4300,5860,2697687Australia-Oceania,New Zealand,37100,268838,4474549Middle East,Yemen,2500,527968,27392779South Asia,Pakistan,5100,796095,201995540Europe,Albania,11900,28748,3038594Australia-Oceania,Samoa,5400,2831,198926Australia-Oceania,Norfolk Island,\N,36,2210
